using RepoRanger.Domain.Common;

namespace RepoRanger.Domain.Dependencies.Entities;

public class Vulnerability : Entity
{
    private Vulnerability() { }

    public Guid Id { get; set; }
    public string OsvId { get; private set; } = string.Empty;
    public Guid DependencyVersionId { get; private set; }
    public DateTimeOffset? Published { get; private set; }
    public DateTimeOffset? Withdrawn { get; private set; }
    public string Summary { get; private set; } = string.Empty;
    public string Details { get; private set; } = string.Empty;

    public static Vulnerability Create(string osvId, Guid versionId, DateTimeOffset? published, DateTimeOffset? withdrawn,
        string summary, string details) => new()
    {
        OsvId = osvId,
        DependencyVersionId = versionId,
        Published = published,
        Withdrawn = withdrawn,
        Summary = summary,
        Details = details
    };
}