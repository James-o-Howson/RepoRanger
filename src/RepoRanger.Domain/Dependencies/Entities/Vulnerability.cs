using RepoRanger.Domain.Common;
using RepoRanger.Domain.Dependencies.ValueObjects;

namespace RepoRanger.Domain.Dependencies.Entities;

public class Vulnerability : BaseAuditableEntity
{
    private Vulnerability() { }

    public VulnerabilityId Id { get; } = VulnerabilityId.New;
    public string OsvId { get; private set; } = string.Empty;
    public DependencyVersionId DependencyVersionId { get; private set; }
    public DependencyVersion DependencyVersion { get; private set; } = null!;
    public DateTimeOffset? Published { get; private set; }
    public DateTimeOffset? Withdrawn { get; private set; }
    public string Summary { get; private set; } = string.Empty;
    public string Details { get; private set; } = string.Empty;

    public static Vulnerability Create(string osvId, DependencyVersionId versionId, DateTimeOffset? published, DateTimeOffset? withdrawn,
        string summary, string details) => new()
    {
        OsvId = osvId,
        DependencyVersionId = versionId,
        Published = published,
        Withdrawn = withdrawn,
        Summary = summary,
        Details = details
    };
}