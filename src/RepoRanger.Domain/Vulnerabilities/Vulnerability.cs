using RepoRanger.Domain.Common;

namespace RepoRanger.Domain.Vulnerabilities;

public class Vulnerability : Entity
{
    private Vulnerability() { }

    public int Id { get; set; }
    public string OsvId { get; private set; } = string.Empty;
    public string DependencyName { get; private set; } = string.Empty;
    public DateTimeOffset? Published { get; private set; }
    public DateTimeOffset? Withdrawn { get; private set; }
    public string Summary { get; private set; } = string.Empty;
    public string Details { get; private set; } = string.Empty;

    public static Vulnerability Create(string osvId, string dependencyName, DateTimeOffset? published, DateTimeOffset? withdrawn,
        string summary, string details) => new()
    {
        OsvId = osvId,
        DependencyName = dependencyName,
        Published = published,
        Withdrawn = withdrawn,
        Summary = summary,
        Details = details
    };
}