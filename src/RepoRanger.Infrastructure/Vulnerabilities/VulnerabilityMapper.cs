using RepoRanger.Domain.Dependencies.Entities;
using RepoRanger.Domain.Dependencies.ValueObjects;
using ThirdPartyClients.Generated;

namespace RepoRanger.Infrastructure.Vulnerabilities;

internal static class VulnerabilityMapper
{
    public static IEnumerable<Vulnerability> ToVulnerabilities(this V1BatchVulnerabilityList batchVulnerabilities, DependencyVersionId versionId)
    {
        return batchVulnerabilities.Results.SelectMany(r => r.Vulns)
            .Select(v => Vulnerability.Create(v.Id, versionId, v.Published, v.Withdrawn, v.Summary, v.Details));
    }
}