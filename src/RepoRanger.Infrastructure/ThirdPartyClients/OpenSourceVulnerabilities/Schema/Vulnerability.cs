using System.Text.Json.Serialization;
using OSV.Schema;

namespace RepoRanger.Infrastructure.ThirdPartyClients.OpenSourceVulnerabilities.Schema;

public sealed class Vulnerability
{
    [JsonPropertyName("schema_version")]
    public string SchemaVersion { get; set; } = null!;
    
    [JsonPropertyName("id")]
    public string Id { get; set; } = null!;
    
    [JsonPropertyName("modified")]
    public DateTimeOffset Modified { get; set; }
    
    [JsonPropertyName("published")]
    public DateTimeOffset Published { get; set; }
    
    [JsonPropertyName("withdrawn")]
    public DateTimeOffset? Withdrawn { get; set; }
    
    [JsonPropertyName("aliases")]
    public IEnumerable<string>? Aliases { get; set; }
    
    [JsonPropertyName("related")]
    public IEnumerable<string>? Related { get; set; }
    
    [JsonPropertyName("summary")]
    public string Summary { get; set; } = null!;
    
    [JsonPropertyName("details")]
    public string Details { get; set; } = null!;
    
    [JsonPropertyName("affected")]
    public IEnumerable<Affected> Affected { get; set; } = null!;
    
    [JsonPropertyName("references")]
    public IEnumerable<Reference>? References { get; set; } = null!;
    
    [JsonPropertyName("severity")]
    public IEnumerable<Severity>? Severity { get; set; }
    
    [JsonPropertyName("credits")]
    public IEnumerable<Credit>? Credits { get; set; }
    
    [JsonPropertyName("database_specific")]
    public Dictionary<string, object>? DatabaseSpecific { get; set; }
}
